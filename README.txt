Some extra notes:

Dec 1st: Some updates regarding to checking illegal inputs might lead to minor deviation of line numbers differing from the M4 file. 